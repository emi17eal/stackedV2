# **stackedV2**

Contract for the StackedToads new project. The project is a spin on the OlympusDAO rebasing, with different bonding system and a different rebase token belonging to NFTs themselves. This way, one can easily stake their token directly into their NFT, and the NFTs act as nodes of the project.

## Contracts
NFTContract is a standard NFT contract using ERC721A to optimise storage and reduce gas. This is fairly self explanatory.
The only thing I should point out is that a merkleProof array must be generated by the front-end when the user logs into their metamask, it is then passed into the function to prove the user is on the WL.

STACK is a just an ERC20 token.

reSTACK is a staked rebasing form of STACK that is only ownable by the NFTs of the protocol. Quite basically, I have rewritten the ERC20 contract to belong to uint32 instead of addresses. I am still to test the gas tradeoffs of using uint32 for storage over uint256 at run-time in functions as the EVM works backwards from uint256, making uint256 more efficient at run-time but less when storing variables - seems a bit counter intuitive to me. 

Staking is the staking contract, it lets NFT owners stake their STACK. Whilst in the warmup period, the stack is owned by the stakingContract NFT - which will also be the character in the map on the front-end that the user interacts with to stake. I have also made it so that users can create a pool so that outsiders can stake into their NFT, the users will get to choose the deposit fee and minimum time the pool must be open for. I initially experimented with this, but the gas is quite heavy when closing large pools; so we are just going to have some protocol owned pools permanently open to bring in revenue from the deposit fees. I will consider opening user-owned pools later on in the project, the idea is to let users game the fees to try to bring in more outsiders into the project, with the biggest pools being rewarded big.

Staking Distributor is called by the staking contract to rebase. Also called by the bondContract to mint bonding rewards to bondContract. 

BondDepo is the bonding contract. The protocol can create new bonds **providing they are paired with WETH on uniswap** (will add a layer of protection to make sure protocol cant do otherwise). I have used this method as it removes the need for oracles and uses on-chain price data to relate the principle price to the stack price. When users buy bonds they can choose their vesting period which will be a slider on the front end, and this impacts the discount they get. Users can also buy stakedBonds which they will need an NFT to do, and then they can claim it directly into their NFT. On the front end, I think we should have it so that the user can see their NFTs and they click the NFT they want to stake into etc (same with staking). The bonding contract will also have its own NFT in order for the contract to hold rebasing stack until the vesting period is over. This will also be the character on the front end that the user interacts with.
